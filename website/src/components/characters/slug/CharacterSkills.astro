---
// Character skills and tool proficiencies component
import { formatAbilityModifier } from "@/utils/characterUtils";
import type { CollectionEntry } from "astro:content";

interface Props {
  character: CollectionEntry<"characters">;
}

const { character } = Astro.props;
---

<div class="flex gap-0.5 text-xs font-semibold text-text-secondary">
  <div>
    <h4
      class="font-semibold text-text-primary bg-surface-tertiary text-center mb-1 px-2 py-1 border-b border-hero-red"
    >
      Skills
    </h4>
    {
      character.data.skills && character.data.skills.length > 0 && (
        <div class="mb-4">
          <div class="grid grid-cols-2 gap-0.5">
            {character.data.skills.map((skill: any) => (
              <div
                class="flex items-center gap-1 px-2 py-0.5 text-center rounded-full border border-border-primary"
                title={`${skill.name} (${skill.ability.toUpperCase()}) - Passive: ${skill.passive}`}
              >
                {/* Proficiency/Expertise icon */}
                <span class="w-4 flex items-center justify-center">
                  {skill.expertise ? (
                    <svg
                      viewBox="0 0 24 24"
                      class="w-3.5 h-3.5 text-hero-red fill-current"
                    >
                      <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z" />
                    </svg>
                  ) : skill.proficient ? (
                    <svg
                      viewBox="0 0 24 24"
                      class="w-3.5 h-3.5 text-accent-400 fill-current"
                    >
                      <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4Z" />
                    </svg>
                  ) : null}
                </span>
                <span
                  class={`w-6 p-0.5 text-text-primary ${skill.proficient ? "font-bold" : ""}`}
                >
                  {skill.key}
                </span>
                <span
                  class={`w-6 p-0.5 border-l border-border-primary ${skill.proficient ? "text-accent-400" : "text-text-secondary"}`}
                >
                  {formatAbilityModifier(skill.modifier)}
                </span>
                <span class="w-6 p-0.5 border-l border-border-primary text-text-tertiary">
                  {skill.passive}
                </span>
              </div>
            ))}
          </div>
        </div>
      )
    }
  </div>
  <div>
    <h4
      class="font-semibold text-text-primary bg-surface-tertiary text-center mb-2 px-2 py-1 border-b border-hero-red"
    >
      Tools
    </h4>
    {
      character.data.tools && character.data.tools.length > 0 && (
        <div class="mb-4">
          <div class="space-y-1">
            {character.data.tools.map((tool: any) => (
              <div
                class="bg-surface-secondary p-1.5 rounded text-xs flex items-center"
                title={`${tool.name} (${tool.ability.toUpperCase()}) - Modifier: ${formatAbilityModifier(tool.modifier)}`}
              >
                <span class="w-4 flex items-center justify-center">
                  {tool.expertise ? (
                    <svg
                      viewBox="0 0 24 24"
                      class="w-3.5 h-3.5 text-hero-red fill-current"
                    >
                      <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z" />
                    </svg>
                  ) : tool.proficient ? (
                    <svg
                      viewBox="0 0 24 24"
                      class="w-3.5 h-3.5 text-accent-400 fill-current"
                    >
                      <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4Z" />
                    </svg>
                  ) : null}
                </span>
                <span
                  class={`font-medium text-text-primary ${tool.proficient ? "font-bold" : ""}`}
                >
                  {tool.name}
                </span>
                <span
                  class={`ml-1 ${tool.proficient ? "text-accent-400" : "text-text-secondary"}`}
                >
                  {formatAbilityModifier(tool.modifier)}
                </span>
              </div>
            ))}
          </div>
        </div>
      )
    }
  </div>
</div>
